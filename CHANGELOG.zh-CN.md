# 更新日志

简体中文 · [English](CHANGELOG.md)

本文件记录 Cockpit Tools 的所有重要变更。

格式参考 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)。

---
## [0.6.0] - 2026-02-08

### 新增
- **GitHub Copilot 账号管理**：支持 OAuth/Token/JSON 导入、配额状态、订阅标识、标签与批量操作，并提供账号总览界面。
- **GitHub Copilot 多开实例**：支持 VS Code Copilot 多实例管理，包含独立配置、启动/停止与实例生命周期管理。

### 变更
- **仪表盘与导航**：新增 GitHub Copilot 入口与总览卡片，和 Antigravity/Codex 并列展示。
- **启动路径行为**：回滚最近的路径自动重探测变更，恢复原有检测流程。

### 修复
- **Windows 构建告警**：收敛平台特定的进程处理逻辑，避免环境变量被 move 导致的编译告警。

---
## [0.5.4] - 2026-02-07

### 新增
- **Codex OAuth 登录会话命令集**：新增 `codex_oauth_login_start` / `codex_oauth_login_completed` / `codex_oauth_login_cancel`，统一以 `loginId + authUrl` 作为启动返回模型。
- **OAuth 超时事件协议**：后端新增超时事件载荷（`loginId`、`callbackUrl`、`timeoutSeconds`），用于前端做可控重试。

### 变更
- **Codex OAuth 流程对齐**：从“直接用 code 完成”调整为“会话化完成”（后端按会话缓存回调 code，前端按 `loginId` 完成登录）。
- **授权交互顺序**：先在弹窗内展示授权链接，再由用户手动点击打开浏览器。
- **超时重试交互**：超时后主按钮由 `在浏览器中打开` 切换为 `刷新授权链接`；刷新成功后自动切回 `在浏览器中打开`。
- **超时策略**：超时后不再自动循环重建授权，会话重试改为用户手动触发。
- **OAuth 日志收敛**：日志调整为会话创建/启动/超时/取消/完成等关键节点，移除冗长明细输出。

### 移除
- **旧版 Codex OAuth 命令**：移除 `prepare_codex_oauth_url`、`complete_codex_oauth`、`cancel_codex_oauth` 及前端/服务层回退链路。

### 修复
- **回调重复完成风险**：前端增加会话与并发保护，降低回调重复触发导致的二次完成竞态。
- **超时样式重复问题**：合并弹窗超时态展示，修复重复红色错误区样式。

---
## [0.5.3] - 2026-02-06

### 新增
- **空白实例初始化方式**：新建实例新增初始化方式单选（复制来源实例 / 空白实例），支持只创建空目录。
- **未初始化引导弹窗**：空白实例在未初始化时点击绑定账号会弹出引导弹窗，支持“立即启动”完成初始化。
- **实例排序控件**：多开实例工具栏新增排序字段（创建时间 / 启动时间）与正序/倒序切换。
- **应用内删除确认弹窗**：实例删除确认改为应用内弹窗（含右上角关闭），不再依赖系统确认框。

### 变更
- **实例状态模型扩展**：Antigravity/Codex 实例返回数据新增 `initialized` 状态，前后端统一使用。
- **绑定流程约束**：未初始化实例禁止绑定账号（前端置灰 + 后端校验），并返回明确错误提示。
- **实例列表布局优化**：状态独立成列并紧挨实例列；操作列改为 sticky 覆盖层，小窗口下始终可见且不透底。
- **下拉交互分离**：列表中的账号下拉改为 portal（容器外）渲染，弹框内下拉保持容器内渲染，避免裁切和样式串扰。
- **PID 展示逻辑**：实例未运行时不再显示 PID。
- **启动后自动刷新**：实例启动后增加约 2 秒延迟刷新，减少“已初始化但列表仍显示待初始化”的滞后。
- **国际化补齐**：补齐并对齐 17 种语言的相关新键（初始化方式、待初始化提示、排序等）。

### 修复
- **删除确认卡住问题**：修复在特定交互状态下删除确认框点击无响应的问题。

---
## [0.5.2] - 2026-02-06

### 变更
- **账号切换绑定同步**：切换 Antigravity 账号后，默认实例绑定账号会自动同步为当前所选账号。
- **Codex 账号切换绑定同步**：切换 Codex 账号后，默认 Codex 实例绑定账号会自动同步为当前所选账号。
- **实例账号下拉交互**：实例列表内联账号下拉改为统一开关状态控制，同一时间仅展开一个下拉菜单。
- **实例页面 UI 优化**：优化列表/表格布局、内联账号选择器可读性，以及深色模式和移动端展示效果。

## [0.5.1] - 2026-02-05

### 新增
- **唤醒调度后端同步**：新增调度同步命令，并提供后端历史记录加载/清理接口。
- **下载目录辅助**：新增获取下载目录的系统接口。
- **启动路径管理**：通用设置新增 Codex 启动路径，并提供启动路径探测/设置命令。

### 变更
- **唤醒历史存储**：历史记录改为后端持久化，保留数量提升至 100 条。
- **macOS 启动策略**：优先直接执行可执行文件（可拿 PID），失败后 `.app` 走 `open -a` 兜底。
- **重置默认路径**：改为自动探测并回填，而非清空。
- **账号切换**：启动后更新默认实例 PID；路径缺失时触发应用路径弹框事件。
- **文档**：补充 Antigravity/Codex 多开实例说明与图片占位。
- **国际化**：新增启动路径相关翻译键并保持一致性。

### 修复
- **macOS 应用选择**：优化 `.app` 选择/启动流程，减少权限错误。

## [0.5.0] - 2026-02-04

### 新增
- **Antigravity 最新版本兼容性**: 增强对 Antigravity 1.16.5+ 版本的账号切换支持。
  - 支持新的统一状态同步格式（`antigravityUnifiedStateSync.oauthToken`）。
  - 向下兼容旧版本的数据格式。
- **Antigravity 多实例支持**: 支持同时运行多个 Antigravity IDE 实例。
  - 每个实例使用独立的用户配置文件和数据目录运行。
  - 支持不同账号同时登录不同实例。
  - 通过专用管理界面创建、启动、重启和删除实例。
  - 自动检测正在运行的实例并实时显示状态。
- **Codex Mac 桌面端多实例支持**: 支持在 macOS 上同时运行多个 Codex 桌面实例。
  - 每个实例使用独立的用户配置文件和应用数据目录运行。
  - 支持不同账号同时登录不同实例。
  - 通过专用管理界面创建、启动、重启和删除实例。
  - 自动检测正在运行的实例并实时显示状态。
  - 智能重启策略：在切换账号时可选择"始终重启"、"从不重启"或"询问我"。

### 变更
- **实例管理界面**: 新增专用的实例管理页面，采用现代化列表界面。
- **导航菜单**: 在侧边栏中新增"实例管理"菜单项，可快速访问实例管理功能。

---
## [0.4.10] - 2026-01-31

### 变更
- **单账号配额刷新**：单个卡片刷新现在总是请求实时 API，不再受 60 秒缓存限制。
- **缓存目录隔离**：桌面端配额缓存目录改为 `quota_api_v1_desktop`，避免与插件端共享/覆盖。

## [0.4.9] - 2026-01-31

### 新增
- **配额错误详情**：记录账号最近一次配额错误，并在独立错误详情弹窗中展示（支持链接渲染）。
- **403 禁止状态展示**：账号被拒绝访问时显示锁定状态，并在配额区域提示。

### 变更
- **配额查询结果**：返回结构化错误信息（code/message）并写入账号状态。
- **账号状态提示**：合并禁用/刷新异常/无权限提示文案。
- **账号操作区**：收紧卡片操作按钮间距与尺寸。

### 修复
- **国际化**：补齐账号错误操作与错误详情字段的缺失翻译。

## [0.4.8] - 2026-01-30

### 新增
- **OpenCode 同步开关**：在 Codex 账号管理中加入开关，用于控制 OpenCode 同步/重启。

### 变更
- **OpenCode 认证同步**：切换账号时同步 auth.json，补齐 OAuth 字段并使用跨平台路径。
- **OpenCode 启动逻辑**：未运行则直接启动，运行中则重启。
- **AccountId 对齐**：账号 ID 提取逻辑对齐官方扩展（仅 access_token）。
- **界面文案**：OpenCode 启动路径提示去掉固定默认路径文案。

### 修复
- **i18n**：补齐缺失翻译并确保各语言键一致。

## [0.4.7] - 2026-01-30

### 新增
- **授权接口缓存**：缓存授权接口原始响应，落盘到 `cache/quota_api_v1`。
- **缓存来源标记**：接口缓存新增 `customSource` 字段，用于标记写入来源。
- **缓存命中日志**：配额刷新新增缓存命中/过期日志。

### 变更
- **旧缓存桥接**：旧缓存读取逻辑改为读取新的接口缓存，保持启动期快速回显。

## [0.4.6] - 2026-01-29

### 新增
- **更新通知**：更新弹窗现在会显示更新内容，支持中英文本地化。

### 修复
- **国际化**：修复 Codex 添加账号弹窗中缺失的翻译（OAuth、Token、导入选项卡）。
- **可访问性**：改进 FREE 订阅标签的对比度，提升浅色模式下的可读性。
- **国际化**：修复删除标签确认对话框中硬编码的中文字符串。

---
## [0.4.3] - 2026-01-29

### 新增
- **Codex 标签管理**：新增 Codex 账号全局标签删除功能。
- **账号过滤与标签**：
  - 支持账号标签管理，可为账号添加/删除标签。
  - 支持按标签过滤账号列表。
- **紧凑视图**：
  - 新增账户列表紧凑视图模式，显示更紧凑的信息。
  - 支持在紧凑视图中查看账号禁用及警告状态图标。
  - 支持在紧凑视图中自定义模型分组显示。

### 优化
- **智能推荐**：优化仪表盘推荐算法，自动排除已禁用、受限或无模型的无效账号。
- **界面优化**：
  - 优化紧凑视图的交互体验。
  - 移除列表视图中冗余的标签渲染，提升界面整洁度。

## [0.4.2] - 2026-01-29

### 新增
- **更新弹框**：检查更新统一为弹框提示，支持从“关于”页直接触发。
- **刷新频率**：新增 Codex 账号自动刷新频率设置（默认 10 分钟）。
- **账号警告**：账号刷新失败时在列表中标记警告，支持凭证无效提示。

### 变更
- **更新体验**：更新提示样式统一为非透明弹窗，风格与现有弹框一致。

## [0.4.1] - 2026-01-29

### 新增
- **关闭确认弹窗**：新增关闭窗口确认弹窗，支持最小化/退出并可记住选择。
- **关闭行为设置**：在 设置 → 通用 中支持配置默认关闭行为。
- **托盘菜单**：新增系统托盘菜单，提供导航快捷入口与配额刷新操作。
- **排序增强**：支持按分组配额重置时间排序，以及 Codex 周配额/5 小时配额重置时间排序。

### 变更
- **国际化**：补齐关闭弹窗、关闭行为与重置时间排序的 17 种语言翻译。
- **界面优化**：为新关闭弹窗及相关布局做了样式优化。


## [0.4.0] - 2026-01-28

### 新增
- **可视化仪表盘**: 全新的仪表盘界面，提供 Antigravity 和 Codex 账号状态的一站式总览。
- **Codex 支持**: 全面支持 Codex 账号管理。
  - 查看 5小时 (Hourly) 和周 (Weekly) 配额。
  - 自动识别账号订阅计划 (Basic, Plus, Team, Enterprise)。
  - 独立的账号列表和卡片视图。
- **品牌重塑**: 项目正式更名为 **Cockpit Tools**。
- **赞助与反馈**: 在 设置 -> 关于 页面新增 "赞助支持" 和 "意见反馈" 入口，加强社区互动。

### 变更
- **字体优化**: 默认字体切换为 **Inter**，提升阅读体验。
- **文档更新**: 全面更新 README 文档，增加最新截图和结构化的功能概览。
- **国际化**: 更新所有 17 种语言的翻译，覆盖新的仪表盘和 Codex 功能。


## [0.3.3] - 2026-01-24

### Added
- **账号管理**: 新增按创建时间排序功能。账号现在默认按创建时间倒序排列（新创建的在前）。
- **数据库**: 为 `accounts` 表新增了 `created_at` 字段，支持精确的账号追踪。
- **国际化**: 为全部 17 种语言完善了"创建时间"相关的翻译支持。

## [0.3.2] - 2026-01-23

### Added
- **工程化**: 新增版本号自动同步脚本。`package.json` 版本号现在会自动同步到 `tauri.conf.json` 和 `Cargo.toml`。
- **工程化**: 新增 Git pre-commit 钩子，强制要求在版本变更时更新 Changelog。

## [0.3.1] - 2026-01-23

### Changed
- **维护**: 常规版本更新与依赖维护。

## [0.3.0] - 2026-01-22

### 新增
- **模型分组管理**: 新增分组管理弹窗，支持自定义模型分组显示名称。
  - 四个固定分组：Claude 4.5、G3-Pro、G3-Flash、G3-Image。
  - 自定义分组名称会应用到账号卡片和排序下拉菜单。
  - 分组配置本地持久化，首次启动时自动初始化。
- **账号排序**: 为账号列表新增排序功能。
  - 默认按综合配额排序。
  - 支持按特定分组配额排序（如按 Claude 4.5 配额）。
  - 分组配额相等时，按总配额进行二次排序。
- **国际化**: 为全部 17 种支持语言添加了排序和分组管理相关翻译。

### 变更
- 账号卡片上的模型名称现在动态反映自定义分组名称。
- 移除"其他"分组显示，简化分组模型。
- 解耦桌面应用与 VS Code 插件之间的分组配置。

---

## [0.2.0] - 2026-01-21

### 新增
- **更新检查**: 实现通过 GitHub Releases API 自动检查更新。
  - 应用启动时自动检查新版本（默认每 24 小时检查一次）。
  - 发现新版本时，右上角弹出精美的毛玻璃风格通知卡片。
  - 在 **设置 → 关于** 页面新增手动"检查更新"按钮，支持实时状态反馈。
  - 点击通知或下载按钮可直接跳转到 GitHub Release 页面下载。
- **国际化**: 为全部 17 种支持语言添加了更新通知相关翻译。

---

## [0.1.0] - 2025-01-21

### 新增
- **账号管理**: 完整的账号管理功能，支持 OAuth 授权。
  - 通过 Google OAuth 授权流程添加账号。
  - 支持从 Antigravity Tools (`~/.antigravity_tools/`)、本地 Antigravity 客户端或 VS Code 插件导入账号。
  - 导出账号为 JSON 格式，便于备份和迁移。
  - 支持删除单个或多个账号，带确认提示。
  - 支持拖拽排序账号列表。
- **配额监控**: 实时监控所有账号的模型配额。
  - 卡片视图和列表视图两种显示模式。
  - 按订阅类型（PRO/ULTRA/FREE）筛选账号。
  - 自动刷新，可配置刷新间隔（2/5/10/15 分钟或禁用）。
  - 一键快速切换账号。
- **设备指纹**: 全面的设备指纹管理功能。
  - 生成新指纹，支持自定义名称。
  - 捕获当前设备指纹。
  - 将指纹绑定到账号，实现设备模拟。
  - 从 Antigravity Tools 或 JSON 文件导入指纹。
  - 预览指纹配置详情。
- **唤醒任务**: 自动化账号唤醒调度系统。
  - 创建多个唤醒任务，支持独立控制。
  - 支持定时、Crontab 和配额重置三种触发模式。
  - 多模型和多账号选择。
  - 自定义唤醒词和最大 Token 限制。
  - 触发历史记录，包含详细日志。
  - 全局唤醒开关，快速启用/禁用。
- **Antigravity Cockpit 集成**: 与 VS Code 插件深度集成。
  - WebSocket 服务器实现双向通信。
  - 支持从插件端远程切换账号。
  - 账号导入/导出同步。
- **设置**: 完善的应用设置功能。
  - 语言选择（支持 17 种语言）。
  - 主题切换（浅色/深色/跟随系统）。
  - WebSocket 服务配置，支持自定义端口。
  - 数据目录和指纹目录快捷入口。
- **国际化**: 完整的国际化支持，覆盖 17 种语言。
  - 🇨🇳 简体中文, 🇹🇼 繁體中文, 🇺🇸 English
  - 🇯🇵 日本語, 🇰🇷 한국어, 🇻🇳 Tiếng Việt
  - 🇩🇪 Deutsch, 🇫🇷 Français, 🇪🇸 Español, 🇮🇹 Italiano, 🇵🇹 Português
  - 🇷🇺 Русский, 🇹🇷 Türkçe, 🇵🇱 Polski, 🇨🇿 Čeština, 🇸🇦 العربية
- **界面体验**: 现代精致的用户界面。
  - 毛玻璃设计风格，配合流畅动画。
  - 响应式侧边栏导航。
  - 深色模式支持，无缝主题切换。
  - 原生 macOS 窗口控件和拖拽区域。

### 技术栈
- 基于 Tauri 2.0 + React + TypeScript 构建。
- 使用 SQLite 数据库进行本地数据持久化。
- 使用系统钥匙串安全存储凭证。
- 跨平台支持（当前以 macOS 为主，Windows/Linux 计划中）。
